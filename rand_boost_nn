#2. Implement hyperparameter tuning for different machine learning algorithms including Random Forest,
#Boosting Algorithms (e.g., XGBoost, LightGBM), and Neural Networks


import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, confusion_matrix
from sklearn.datasets import load_breast_cancer

# Models
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier
from xgboost import XGBClassifier
from sklearn.neural_network import MLPClassifier

# -------- Load Dataset (No file needed) --------
data = load_breast_cancer()
X, y = data.data, data.target

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Scale Features
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

# -------- Basic Models --------
models = {
    "SVM": SVC(),
    "RandomForest": RandomForestClassifier(),
    "XGBoost": XGBClassifier(eval_metric='mlogloss'),
    "NeuralNet": MLPClassifier(max_iter=500)
}

print("\n--- Basic Model Accuracy ---")
results_basic = {name: accuracy_score(y_test, model.fit(X_train, y_train).predict(X_test))
                 for name, model in models.items()}
print(results_basic)

# -------- Hyperparameter Tuning --------
params = {
    "SVM": {"C":[0.1,1,10], "kernel":["linear","rbf"]},
    "RandomForest": {"n_estimators":[50,100], "max_depth":[None,10]},
    "XGBoost": {"n_estimators":[50,100], "max_depth":[3,5]},
    "NeuralNet": {"hidden_layer_sizes":[(50,),(100,)], "activation":["relu","tanh"]}
}

tuned_results = {}
best_models = {}

print("\n--- Tuned Model Accuracy ---")
for name, model in models.items():
    grid = GridSearchCV(model, params[name], cv=3)
    grid.fit(X_train, y_train)
    best_models[name] = grid.best_estimator_
    acc = accuracy_score(y_test, best_models[name].predict(X_test))
    tuned_results[name] = acc
    print(f"{name}: {acc:.4f} | Best Params: {grid.best_params_}")

# -------- Confusion Matrix for Best Model --------
best_model_name = max(tuned_results, key=tuned_results.get)
best_model = best_models[best_model_name]

cm = confusion_matrix(y_test, best_model.predict(X_test))
plt.figure(figsize=(5,4))
sns.heatmap(cm, annot=True, cmap="Blues", fmt='d')
plt.title(f"Confusion Matrix - Best Model: {best_model_name}")
plt.show()
